2025-06-12 11:35:52,378 - INFO - --------------------------------------------
2025-06-12 11:35:52,378 - INFO - Entered Main Function...
2025-06-12 11:35:52,407 - WARNING - No records found within the given date range..!
2025-06-12 11:35:52,408 - ERROR - Reconciliation error: handler() missing 1 required positional argument: 'service_name'
Traceback (most recent call last):
  File "d:\GitHub\RPA\src\app.py", line 158, in reconciliation
    return handler("", result)
TypeError: handler() missing 1 required positional argument: 'service_name'

2025-06-12 11:37:08,516 - INFO - --------------------------------------------
2025-06-12 11:37:08,516 - INFO - Entered Main Function...
2025-06-12 11:37:09,600 - WARNING - No records found within the given date range..!
2025-06-12 11:37:09,602 - ERROR - Reconciliation error: name 'ser' is not defined
Traceback (most recent call last):
  File "d:\GitHub\RPA\src\app.py", line 158, in reconciliation
    return handler("", result,service_name)
                              ^^^
NameError: name 'ser' is not defined. Did you mean: 'set'?

2025-06-12 11:37:45,206 - INFO - --------------------------------------------
2025-06-12 11:37:45,206 - INFO - Entered Main Function...
2025-06-12 11:37:45,847 - WARNING - No records found within the given date range..!
2025-06-12 11:37:45,850 - ERROR - Reconciliation error: name 'ser' is not defined
Traceback (most recent call last):
  File "d:\GitHub\RPA\src\app.py", line 158, in reconciliation
    return handler("", result,service_name)
                              ^^^
NameError: name 'ser' is not defined. Did you mean: 'set'?

2025-06-12 11:38:37,012 - INFO - --------------------------------------------
2025-06-12 11:38:37,013 - INFO - Entered Main Function...
2025-06-12 11:38:37,537 - WARNING - No records found within the given date range..!
2025-06-12 11:38:37,537 - INFO - Error result sent as API
2025-06-12 11:38:37,537 - INFO - ----------------------------------
2025-06-12 11:40:34,315 - INFO - --------------------------------------------
2025-06-12 11:40:34,315 - INFO - Entered Main Function...
2025-06-12 11:40:34,837 - WARNING - No records found within the given date range..!
2025-06-12 11:40:34,837 - INFO - Error result sent as API
2025-06-12 11:40:34,837 - INFO - ----------------------------------
2025-06-12 11:40:42,366 - INFO - --------------------------------------------
2025-06-12 11:40:42,366 - INFO - Entered Main Function...
2025-06-12 11:40:42,390 - WARNING - No records found within the given date range..!
2025-06-12 11:40:42,390 - INFO - Error result sent as API
2025-06-12 11:40:42,390 - INFO - ----------------------------------
2025-06-12 11:43:35,302 - INFO - --------------------------------------------
2025-06-12 11:43:35,302 - INFO - Entered Main Function...
2025-06-12 11:43:35,918 - WARNING - No records found within the given date range..!
2025-06-12 11:43:35,919 - INFO - Error result sent as API
2025-06-12 11:43:35,919 - INFO - ----------------------------------
2025-06-12 11:44:55,872 - INFO - --------------------------------------------
2025-06-12 11:44:55,872 - INFO - Entered Main Function...
2025-06-12 11:44:55,906 - INFO - Records found within the date range. Running reconciliation...
2025-06-12 11:44:55,907 - INFO - Entering Reconciliation for AEPS Service
2025-06-12 11:44:55,914 - INFO - AEPS service: Column 'SERIALNUMBER' renamed to 'REFID'
2025-06-12 11:44:55,914 - INFO - Fetching data from HUB for AEPS
2025-06-12 11:44:55,914 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 11:44:57,355 - INFO - Fetching Data from EBO Wallet Transaction
2025-06-12 11:44:57,356 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 11:44:58,597 - INFO - Filteration Starts for AEPS service
2025-06-12 11:44:58,768 - INFO - Filteration Ends
2025-06-12 11:44:58,768 - INFO - Reconciliation Ends
2025-06-12 11:44:58,769 - INFO - Error result sent as API
2025-06-12 11:44:58,769 - INFO - ----------------------------------
2025-06-12 11:50:39,402 - INFO - --------------------------------------------
2025-06-12 11:50:39,403 - INFO - Entered Main Function...
2025-06-12 11:50:39,860 - INFO - Records found within the date range. Running reconciliation...
2025-06-12 11:50:39,860 - INFO - Entering Reconciliation for AEPS Service
2025-06-12 11:50:39,861 - INFO - AEPS service: Column 'SERIALNUMBER' renamed to 'REFID'
2025-06-12 11:50:39,861 - INFO - Fetching data from HUB for AEPS
2025-06-12 11:50:39,862 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 11:50:41,380 - INFO - Fetching Data from EBO Wallet Transaction
2025-06-12 11:50:41,380 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 11:50:42,749 - INFO - Filteration Starts for AEPS service
2025-06-12 11:50:42,834 - INFO - Filteration Ends
2025-06-12 11:50:42,834 - INFO - Reconciliation Ends
2025-06-12 11:50:42,834 - INFO - Error result sent as API
2025-06-12 11:50:42,834 - INFO - ----------------------------------
2025-06-12 11:51:51,258 - INFO - --------------------------------------------
2025-06-12 11:51:51,258 - INFO - Entered Main Function...
2025-06-12 11:51:51,295 - INFO - Records found within the date range. Running reconciliation...
2025-06-12 11:51:51,296 - INFO - Entering Reconciliation for AEPS Service
2025-06-12 11:51:51,297 - INFO - AEPS service: Column 'SERIALNUMBER' renamed to 'REFID'
2025-06-12 11:51:51,297 - INFO - Fetching data from HUB for AEPS
2025-06-12 11:51:51,298 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 11:51:51,299 - ERROR - Error during SQL execution: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query')
[SQL: 
        SELECT 
            mt2.TransactionRefNum AS IHUB_REFERENCE,
            pat.BankRrn AS VENDOR_REFERENCE,
            mt2.TenantDetailId as TENANT_ID,
            u.UserName as IHUB_USERNAME,
            mt2.TransactionStatus AS IHUB_MASTER_STATUS,
            pat.CreationTs AS SERVICE_DATE,
            pat.TransStatus AS service_status,
            pat.Amount as AMOUNT,
            CASE 
                WHEN a.IHubReferenceId IS NOT NULL THEN 'Yes'
                ELSE 'No'
            END AS IHUB_LEDGER_STATUS
        FROM ihubcore.MasterTransaction mt2 
        LEFT JOIN ihubcore.MasterSubTransaction mst
            ON mst.MasterTransactionId = mt2.Id
        LEFT JOIN ihubcore.PsAepsTransaction pat 
            ON pat.MasterSubTransactionId = mst.Id
        LEFT JOIN tenantinetcsc.EboDetail ed
            ON mt2.EboDetailId = ed.Id
        LEFT JOIN tenantinetcsc.`User` u
            ON u.id = ed.UserId
        LEFT JOIN (
            SELECT DISTINCT iwt.IHubReferenceId AS IHubReferenceId
            FROM ihubcore.IHubWalletTransaction iwt
            WHERE DATE(iwt.CreationTs) BETWEEN %(start_date)s AND CURRENT_DATE()
        ) a 
            ON a.IHubReferenceId = mt2.TransactionRefNum
        WHERE pat.TransMode = %(transaction_type)s
        AND DATE(pat.CreationTs) BETWEEN %(start_date)s AND %(end_date)s
    ]
[parameters: {'start_date': datetime.date(2025, 6, 9), 'transaction_type': '2', 'end_date': datetime.date(2025, 6, 9)}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-12 11:51:52,300 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 11:51:53,478 - INFO - Fetching Data from EBO Wallet Transaction
2025-06-12 11:51:53,479 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 11:51:54,634 - INFO - Filteration Starts for AEPS service
2025-06-12 11:51:54,791 - INFO - Filteration Ends
2025-06-12 11:51:54,792 - INFO - Reconciliation Ends
2025-06-12 11:51:54,792 - INFO - Error result sent as API
2025-06-12 11:51:54,792 - INFO - ----------------------------------
2025-06-12 12:01:15,393 - INFO - --------------------------------------------
2025-06-12 12:01:15,393 - INFO - Entered Main Function...
2025-06-12 12:01:15,773 - INFO - Records found within the date range. Running reconciliation...
2025-06-12 12:01:15,774 - INFO - Entering Reconciliation for AEPS Service
2025-06-12 12:01:15,775 - INFO - AEPS service: Column 'SERIALNUMBER' renamed to 'REFID'
2025-06-12 12:01:15,775 - INFO - Fetching data from HUB for AEPS
2025-06-12 12:01:15,775 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 12:01:17,199 - INFO - Fetching Data from EBO Wallet Transaction
2025-06-12 12:01:17,200 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 12:01:18,462 - INFO - Filteration Starts for AEPS service
2025-06-12 12:01:18,564 - INFO - Filteration Ends
2025-06-12 12:01:18,564 - INFO - Reconciliation Ends
2025-06-12 12:01:18,564 - INFO - Result sent as API
2025-06-12 12:01:18,564 - INFO - ----------------------------------
2025-06-12 12:03:30,460 - INFO - --------------------------------------------
2025-06-12 12:03:30,460 - INFO - Entered Main Function...
2025-06-12 12:03:30,830 - INFO - Records found within the date range. Running reconciliation...
2025-06-12 12:03:30,831 - INFO - Entering Reconciliation for AEPS Service
2025-06-12 12:03:30,832 - INFO - AEPS service: Column 'SERIALNUMBER' renamed to 'REFID'
2025-06-12 12:03:30,832 - INFO - Fetching data from HUB for AEPS
2025-06-12 12:03:30,832 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 12:03:32,151 - INFO - Fetching Data from EBO Wallet Transaction
2025-06-12 12:03:32,151 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 12:03:33,321 - INFO - Filteration Starts for AEPS service
2025-06-12 12:03:33,443 - INFO - Filteration Ends
2025-06-12 12:03:33,444 - INFO - Reconciliation Ends
2025-06-12 12:03:33,444 - INFO - Result sent as API
2025-06-12 12:03:33,444 - INFO - ----------------------------------
2025-06-12 12:08:14,398 - INFO - --------------------------------------------
2025-06-12 12:08:14,398 - INFO - Entered Main Function...
2025-06-12 12:08:14,915 - INFO - Records found within the date range. Running reconciliation...
2025-06-12 12:08:14,915 - INFO - Entering Reconciliation for AEPS Service
2025-06-12 12:08:14,916 - INFO - AEPS service: Column 'SERIALNUMBER' renamed to 'REFID'
2025-06-12 12:08:14,916 - INFO - Fetching data from HUB for AEPS
2025-06-12 12:08:14,917 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 12:08:16,433 - INFO - Fetching Data from EBO Wallet Transaction
2025-06-12 12:08:16,434 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 12:08:17,685 - INFO - Filteration Starts for AEPS service
2025-06-12 12:08:17,812 - INFO - Filteration Ends
2025-06-12 12:08:17,812 - INFO - Reconciliation Ends
2025-06-12 12:08:17,812 - INFO - Result sent as API
2025-06-12 12:08:17,813 - INFO - ----------------------------------
2025-06-12 12:11:29,124 - INFO - --------------------------------------------
2025-06-12 12:11:29,124 - INFO - Entered Main Function...
2025-06-12 12:11:29,199 - INFO - Records found within the date range. Running reconciliation...
2025-06-12 12:11:29,206 - INFO - Entering Reconciliation for AEPS Service
2025-06-12 12:11:29,208 - INFO - AEPS service: Column 'SERIALNUMBER' renamed to 'REFID'
2025-06-12 12:11:29,208 - INFO - Fetching data from HUB for AEPS
2025-06-12 12:11:29,209 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 12:11:29,211 - ERROR - Error during SQL execution: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query')
[SQL: 
        SELECT 
            mt2.TransactionRefNum AS IHUB_REFERENCE,
            pat.BankRrn AS VENDOR_REFERENCE,
            mt2.TenantDetailId as TENANT_ID,
            u.UserName as IHUB_USERNAME,
            mt2.TransactionStatus AS IHUB_MASTER_STATUS,
            pat.CreationTs AS SERVICE_DATE,
            pat.TransStatus AS service_status,
            pat.Amount as AMOUNT,
            CASE 
                WHEN a.IHubReferenceId IS NOT NULL THEN 'Yes'
                ELSE 'No'
            END AS IHUB_LEDGER_STATUS
        FROM ihubcore.MasterTransaction mt2 
        LEFT JOIN ihubcore.MasterSubTransaction mst
            ON mst.MasterTransactionId = mt2.Id
        LEFT JOIN ihubcore.PsAepsTransaction pat 
            ON pat.MasterSubTransactionId = mst.Id
        LEFT JOIN tenantinetcsc.EboDetail ed
            ON mt2.EboDetailId = ed.Id
        LEFT JOIN tenantinetcsc.`User` u
            ON u.id = ed.UserId
        LEFT JOIN (
            SELECT DISTINCT iwt.IHubReferenceId AS IHubReferenceId
            FROM ihubcore.IHubWalletTransaction iwt
            WHERE DATE(iwt.CreationTs) BETWEEN %(start_date)s AND CURRENT_DATE()
        ) a 
            ON a.IHubReferenceId = mt2.TransactionRefNum
        WHERE pat.TransMode = %(transaction_type)s
        AND DATE(pat.CreationTs) BETWEEN %(start_date)s AND %(end_date)s
    ]
[parameters: {'start_date': datetime.date(2025, 6, 9), 'transaction_type': '2', 'end_date': datetime.date(2025, 6, 9)}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-12 12:11:30,212 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 12:11:31,495 - INFO - Fetching Data from EBO Wallet Transaction
2025-06-12 12:11:31,496 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 12:11:32,869 - INFO - Filteration Starts for AEPS service
2025-06-12 12:11:33,020 - INFO - Filteration Ends
2025-06-12 12:11:33,020 - INFO - Reconciliation Ends
2025-06-12 12:11:33,021 - INFO - Result sent as API
2025-06-12 12:11:33,021 - INFO - ----------------------------------
2025-06-12 12:12:26,368 - INFO - --------------------------------------------
2025-06-12 12:12:26,368 - INFO - Entered Main Function...
2025-06-12 12:12:26,732 - INFO - Records found within the date range. Running reconciliation...
2025-06-12 12:12:26,733 - INFO - Entering Reconciliation for RECHARGE Service
2025-06-12 12:12:26,734 - INFO - Recharge service: Column 'REFID' renamed to 'REFID'
2025-06-12 12:12:26,735 - INFO - Fetching data from HUB for RECHARGE
2025-06-12 12:12:26,736 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 12:12:55,259 - INFO - Fetching Data from EBO Wallet Transaction
2025-06-12 12:12:55,260 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 12:12:56,405 - INFO - Entered Tenant filtering function
2025-06-12 12:12:56,406 - INFO - Entered helper function to execute SQL with retry logic
2025-06-12 12:12:57,293 - INFO - Filteration Starts for RECHARGE service
2025-06-12 12:12:57,448 - INFO - Filteration Ends
2025-06-12 12:12:57,449 - INFO - Reconciliation Ends
2025-06-12 12:12:57,503 - INFO - Result sent as API
2025-06-12 12:12:57,503 - INFO - ----------------------------------
